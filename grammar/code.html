<div class="sourceCode" id="cb1"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> <span class="dt">City</span> (makeCities) <span class="kw">where</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">System.IO</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Data.Char</span> (toLower)</span></code></pre></div>
<p>In French, cities generally take the preposition à. For example:</p>
<p>Tu habites à Paris ? Do you live in Paris?</p>
<p>Je veux aller à New York. I want to go to New York.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">City</span> <span class="ot">=</span> <span class="dt">City</span> <span class="dt">String</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">Show</span> <span class="dt">City</span> <span class="kw">where</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show</span> (<span class="dt">City</span> c) <span class="ot">=</span> <span class="st">&quot;The city with preposition is: &quot;</span> <span class="op">++</span> startsWithLe c <span class="op">++</span> <span class="st">&quot;\n&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>makeCities <span class="ot">=</span> <span class="fu">fmap</span> (\city <span class="ot">-&gt;</span> <span class="fu">fmap</span> <span class="dt">City</span> city) getCities</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ot">getCities ::</span> <span class="dt">IO</span> [<span class="dt">String</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>getCities <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> h <span class="ot">&lt;-</span> openFile <span class="st">&quot;/home/alex/DOCS/FRANCES/grammar/cities.txt&quot;</span> <span class="dt">ReadMode</span> <span class="co">-- Use env variable for home path?</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a> s <span class="ot">&lt;-</span> hGetContents h</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span> <span class="op">$</span> <span class="fu">lines</span> s</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ot">startsWithLe ::</span> [<span class="dt">Char</span>] <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>startsWithLe city <span class="ot">=</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">if</span> <span class="fu">map</span> <span class="fu">toLower</span> (<span class="fu">take</span> <span class="dv">2</span> city) <span class="op">==</span> <span class="st">&quot;le&quot;</span> <span class="kw">then</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;Au &quot;</span> <span class="op">++</span> <span class="fu">drop</span> <span class="dv">3</span>  city</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> <span class="kw">else</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>   <span class="st">&quot;A &quot;</span> <span class="op">++</span>  city</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre
class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ot">formatCity ::</span> <span class="dt">City</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>formatCity (<span class="dt">City</span> name) <span class="ot">=</span> <span class="st">&quot;The city with preposition is: &quot;</span> <span class="op">++</span> name</span></code></pre></div>
<p>– &gt; main = do – &gt; let formattedCities = fmap formatCity
makeCities – &gt; mapM_ putStrLn formattedCities</p>
<p>However, there are a few points to remember. As you may know, à + le
becomes au, so cities starting with Le (for example Le Caire – Cairo)
require a contraction after à. For example:</p>
<p>J’habite au Caire. I live in Cairo.</p>
<p>Je vais au Mans. I’m going to Le Mans.</p>
<p>These contractions apply exclusively to cities that begin with Le.
Other well-known examples are Le Cap (Cape Town) and the French port
town of Le Havre.</p>
<p>You may have noticed something crucial from all of these examples: à
can translate as “in” or “to”. There is only one option for the
preposition in French, covering the idea of both being “in” and going
“to” a city.</p>
